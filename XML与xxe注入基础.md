XML与xxe注入基础

XML 3parts DTD文档定义语言|XSL可扩展的样式语言|XLL可扩展链接语言

xxe注入就是XML外部实体注入，通过XML实体，"SYSTEM"关键词导致XML解析器从本地文件或者远程URL中读取数据。so 攻击者通过XML实体传递构造的恶意值，处理程序解析它。

当引用外部实体时，通过构造恶意内容，导致读取任意文件、执行系统命令、探测内网端口、攻击内网网站等。

ENTITY实体

若是在PHP中,libxml_disable_entity_loader设置为TRUE可禁用外部实体注。入另一种作为参数在DTD文件中使用

![image-20210118165146015](C:\Users\49353\AppData\Roaming\Typora\typora-user-images\image-20210118165146015.png)

注释：严格地讲，在 XML 中仅有字符 "<"和"&" 是非法的。省略号、引号和大于号是合法的，但是把它们替换为实体引用是个好的习惯。

XXE漏洞原理：

XML可以从外部读取DTD文件，如果将路径换成另一个文件的路径，服务器在解析XML的时候就能把文件的内容赋给SYSTEM前面的根元素中，只要在XML中让前面的根元素的内容显示出来，就可以读取这个文件，造成了一个任意文件读取的漏洞

XML注入简单利用

构造本地XML接口，包含本地XML文件，乍看返回结果，正常返回后再换为服务器